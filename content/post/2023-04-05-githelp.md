---
title:       "gitの覚え書きまとめ"
subtitle:    "記憶の整理もかねて"
description: "gitの基本"
date:        2023-04-05
author:      "sora"
image:       ""
tags:        ["tech", "memo"]
categories:  ["Tech" ]
---


# 「gitの基本」
***
### gitとは

- ファイルのバージョン管理システム
- 誰がいつ何を編集したのか分かる
- スナップショットのように管理されていていつでも戻れる

### gitの操作の流れ
- ローカルでは主に3つに分かれている　

|名前|役割|
|---|---|
|ワークツリー|作業している場所|
|ステージ|スナップショットを記録する準備場所|
|リポジトリ|スナップショットを記録|

- ワークツリーからステージ
  - `git add`
  - ファイルを圧縮し、名前と紐付ける
- ステージからリポジトリ
  - `git commit`
  - ステージのものに様々な情報を付け加える

- 最終的にリポジトリには　圧縮ファイル　名前が紐付けられたツリー　様々な情報のコミット　の3種類が保存されている 
- リポジトリに追加で変更を加える際には前のとの紐付けデータも併せて保存される

### リポジトリ内容の詳細
- 圧縮ファイル
  - 正式名称は「blobオブジェクト」
  - 実際にはハッシュID
  - 違う内容の`git add`を行うたびに作成される

- ツリーファイル
  - 正式名称は「treeオブジェクト」
  - 構造や名前を持たない圧縮ファイルに構造を与えるための物

- コミットファイル
  - 正式名称は「commitオブジェクト」
  - ファイルの構造に　いつ　誰が　何を　何のために　を保存した物

- これら3つでもってスナップショットを記録している 



# 「gitの流れ」
***

### リポジトリの作成
- 管理したいフォルダに移動し、`git init`と入力
  - .gitファイルが作成される
    - objectsは前著した3つのリポジトリが保存されている
    - configはgitの設定ファイル

### 既にあるリポジトリのコピー
- `git clone <リポジトリのURL>`と入力するとクローンが作成される
  -  コピー内容は本体と.gitディレクトリ

### 変更をステージに追加
- `git add <ファイル名ORディレクトリ名>`で追加したいファイルを、
- `git add .`で全てをステージに追加出来る

### 変更を記録
- `git commit`で記録することが出来る
- `git commit -m "xxx"`でコメントを
- `git commit -v`で変更内容確認など様々なオプションがある

### 現在の状況の確認
- `git status`で現在の変更状況を確認できる
- 確認出来る情報は主に2点
  - ワークツリーとステージの差分
  - ステージとリポジトリの差分
- addやcommitをする前に確認する癖をつけよう

### 何を変更するのか確認
- `git diff` `git diff <ファイル名>`でワークツリーとステージ間の差分を
- `git diff --staged`でステージとリポジトリ間の差分を表示出来る
- 正確には一つ前の物と最新の物の違いを表示するコマンド

### 変更履歴の確認
- `git log`コマンドで今までの変更履歴の確認が出来る
- `git log --oneline`で一行表示
- `git log -n <コミット数>`で一定数
- `git log -p <ファイル名>`で一ファイルのみ
- 最近の変更から順に表示される

### ファイルの削除
- `git rm <ファイル名>`でワークツリーのファイルごと削除
- `git rm -r <ディレクトリ名>`でワークツリーのディレクトリごと削除
- `git rm --cached <ファイル名>`でgitの記録のみ削除

### GitHubへのプッシュ
- 気をつけるのはデフォルトのブランチ名
  - gitの初期設定は`master`
  - githubの初期設定は`main`
  - デフォルトのブランチ名の変更は`git config --global init.defaultBranch main`
  - 既にあるブランチ名の変更は`git branch -m master main`
-  `git remote add origin <github_URL>`でリモートリポジトリを登録できる  
   - このoriginとは以後URLの代わりに使える物
- `git push <リモート名> <ブランチ名>`でGitHubへ送信出来る
  - 通常は`git push -u origin main`となることが多い
  - `-u`コマンドを付けると以後`git push`のみでプッシュ出来るようになる


# 「gitの小技」

### コマンドの簡易入力(エイリアス)
- `git config --global alias.ci commit`でcommitをciと入力できる
  - commitをci statusをst branchをbr chekoutをcoなど
  - --globalを付けるとPC自体の設定を変更できる

### バージョン管理しないファイルの設定
- パスワードなどのファイルやチーム開発で必要では無いものはgit管理から外す
- `.gitignore`ファイルを作成し、その中に記述する
  - `temp.html`はtemp.htmlファイルを無視
  - `temp/`は全てのtempディレクトリを無視
  - `/temp/`はgitignoreのディレクトリから相対パスで判断して無視
  - `*.txt`は.txt全てを無視

# 「変更した物の取り消し」

### ワークツリーの変更をステージ時点に戻す
- `git checkout -- <ファイル名ORディレクトリ名>`で戻す
- `git checkout -- .`で全て戻す

### ステージに追加した変更を取り消す
- 間違った物を`git add`してしまったときに使われる
  - ステージから取り消すだけなのでワークツリーには影響ない
- `git reset HEAD <ファイル名ORディレクトリ名>`ファイルやディレクトリのみ取り消し
- `git reset HEAD .`全ての変更を取り消す

### コミットした物をやり直す
- 正確には一度コミットした物を変更したい場合に使う
  - 変更後のステージに更新するもの
  - PUSHした後に使うのは絶対にNG
- `git commit --amend`で現在のステージに改正される
